<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Our Story üíï A Valentine's Scrapbook</title>

<!-- Fonts -->
<link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@400;600;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Caveat:wght@400;600&family=IM+Fell+English:ital@0;1&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">

<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/MotionPathPlugin.min.js"></script>

<!-- Three.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

<style>
/* ============================================
   GLOBAL & VARIABLES
   ============================================ */
:root {
  --rose:       #e8254a;
  --rose-light: #f9a8b8;
  --rose-deep:  #9b1234;
  --gold:       #c9993b;
  --gold-light: #f0d080;
  --cream:      #fdf6ee;
  --paper:      #f8eed9;
  --ink:        #3d1a24;
  --mauve:      #b06080;
  --midnight:   #1a0a12;
  --burgundy:   #6b1a2e;
  --blush:      #f5c6d0;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

html { scroll-behavior: smooth; }

body {
  background: var(--cream);
  color: var(--ink);
  font-family: 'Caveat', cursive;
  font-size: 18px;
  overflow-x: hidden;
  cursor: none;
}

/* ============================================
   CUSTOM CURSOR
   ============================================ */
#cursor {
  position: fixed;
  width: 18px; height: 18px;
  background: var(--rose);
  border-radius: 50%;
  pointer-events: none;
  z-index: 99999;
  mix-blend-mode: multiply;
  transform: translate(-50%, -50%);
  transition: transform 0.1s ease, width 0.2s, height 0.2s;
}
#cursor-trail {
  position: fixed;
  width: 40px; height: 40px;
  border: 2px solid var(--rose-light);
  border-radius: 50%;
  pointer-events: none;
  z-index: 99998;
  transform: translate(-50%, -50%);
  transition: all 0.15s ease;
  opacity: 0.5;
}
body:hover #cursor { opacity: 1; }

/* ============================================
   LOADING SCREEN
   ============================================ */
#loading-screen {
  position: fixed;
  inset: 0;
  background: radial-gradient(ellipse at center, #2a0a18 0%, #0d0006 100%);
  z-index: 9999;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

#loading-canvas {
  position: absolute;
  inset: 0;
  width: 100%; height: 100%;
}

.loading-content {
  position: relative;
  z-index: 10;
  text-align: center;
  color: var(--rose-light);
}

.loading-initials {
  font-family: 'Playfair Display', serif;
  font-size: clamp(3rem, 8vw, 6rem);
  font-style: italic;
  color: var(--gold-light);
  text-shadow: 0 0 40px rgba(201,153,59,0.8), 0 0 80px rgba(201,153,59,0.4);
  opacity: 0;
  letter-spacing: 0.15em;
}

.loading-subtitle {
  font-family: 'Dancing Script', cursive;
  font-size: clamp(1.2rem, 3vw, 1.8rem);
  color: var(--rose-light);
  opacity: 0;
  margin-top: 0.5rem;
}

.loading-date {
  font-family: 'Caveat', cursive;
  font-size: 1.1rem;
  color: var(--mauve);
  opacity: 0;
  margin-top: 0.3rem;
  font-style: italic;
}

.progress-wrapper {
  margin-top: 2.5rem;
  width: 280px;
  opacity: 0;
}

.progress-label {
  font-family: 'Caveat', cursive;
  font-size: 0.9rem;
  color: var(--mauve);
  margin-bottom: 0.4rem;
  text-align: left;
  font-style: italic;
}

.progress-bar-outer {
  width: 100%;
  height: 12px;
  background: rgba(255,255,255,0.1);
  border-radius: 20px;
  border: 1px solid rgba(201,153,59,0.3);
  overflow: hidden;
  position: relative;
}

.progress-bar-inner {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, var(--rose-deep), var(--rose), var(--gold));
  border-radius: 20px;
  transition: width 0.05s linear;
  box-shadow: 0 0 10px var(--rose);
}

.progress-pages {
  display: flex;
  justify-content: space-between;
  margin-top: 0.5rem;
}
.progress-pages span {
  font-size: 0.75rem;
  color: rgba(255,255,255,0.3);
  font-family: 'Caveat', cursive;
}

/* Floating hearts on loader */
.loader-heart {
  position: absolute;
  pointer-events: none;
  animation: floatHeart var(--dur, 4s) ease-in-out var(--delay, 0s) infinite;
  opacity: 0;
  font-size: var(--size, 1.5rem);
  left: var(--x, 50%);
  bottom: -20px;
}

@keyframes floatHeart {
  0%   { transform: translateY(0) rotate(0deg) scale(1); opacity: 0; }
  10%  { opacity: 1; }
  90%  { opacity: 0.6; }
  100% { transform: translateY(-110vh) rotate(720deg) scale(0.5); opacity: 0; }
}

/* ============================================
   MAIN SITE
   ============================================ */
#main-site {
  opacity: 0;
  min-height: 100vh;
}

/* Paper texture overlay */
#main-site::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image:
    url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='400'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='400' height='400' filter='url(%23n)' opacity='0.04'/%3E%3C/svg%3E");
  pointer-events: none;
  z-index: 1000;
  opacity: 0.5;
}

/* ============================================
   HERO / COVER PAGE
   ============================================ */
#hero {
  position: relative;
  min-height: 100vh;
  background:
    linear-gradient(160deg, #fdf0f3 0%, #f8e0e8 30%, #f3cfd8 60%, #eed5c2 100%);
  display: flex;
  align-items: center;
  justify-content: center;
  overflow: hidden;
}

#hero-canvas {
  position: absolute;
  inset: 0;
  width: 100%; height: 100%;
  z-index: 0;
}

.hero-scrapbook {
  position: relative;
  z-index: 2;
  text-align: center;
  padding: 2rem;
}

.cover-tape {
  position: absolute;
  background: rgba(201,153,59,0.35);
  height: 28px;
  width: 120px;
  border-radius: 3px;
  box-shadow: 0 2px 6px rgba(0,0,0,0.12);
}
.tape-top-left  { top: -14px; left: 30px; transform: rotate(-4deg); }
.tape-top-right { top: -14px; right: 30px; transform: rotate(4deg); }

.cover-frame {
  position: relative;
  background: white;
  padding: 2.5rem 3rem 3rem;
  box-shadow:
    0 4px 20px rgba(155,18,52,0.15),
    0 20px 60px rgba(0,0,0,0.12),
    inset 0 0 0 8px rgba(201,153,59,0.1);
  border: 1px solid rgba(201,153,59,0.3);
  max-width: 600px;
  margin: 0 auto;
}

.cover-frame::before {
  content: '';
  position: absolute;
  inset: 10px;
  border: 2px dashed rgba(201,153,59,0.25);
  pointer-events: none;
}

.cover-ribbon {
  position: absolute;
  top: -2px;
  left: 50%;
  transform: translateX(-50%);
  width: 4px;
  height: 40px;
  background: linear-gradient(180deg, var(--rose), var(--rose-deep));
  box-shadow: 0 2px 8px rgba(232,37,74,0.4);
}
.cover-ribbon::before,
.cover-ribbon::after {
  content: '';
  position: absolute;
  top: 0; left: 50%;
  transform-origin: top center;
  width: 30px; height: 20px;
  background: var(--rose);
  border-radius: 0 50% 50% 0;
  clip-path: polygon(0 0, 100% 30%, 50% 100%, 0 70%);
}
.cover-ribbon::before { transform: translateX(-50%) rotate(-35deg); }
.cover-ribbon::after  { transform: translateX(-50%) rotate(35deg) scaleX(-1); }

.hero-eyelet { display: inline-block; margin-bottom: 0.3rem; }
.hero-eyelet span {
  display: inline-block;
  width: 8px; height: 8px;
  background: var(--gold);
  border-radius: 50%;
  margin: 0 3px;
  box-shadow: 0 0 4px rgba(201,153,59,0.6);
}

.hero-title {
  font-family: 'Playfair Display', serif;
  font-size: clamp(2.5rem, 6vw, 4rem);
  color: var(--rose-deep);
  line-height: 1.15;
  font-style: italic;
  text-shadow: 1px 1px 0 rgba(255,255,255,0.8);
}

.hero-title em {
  font-style: normal;
  color: var(--gold);
  display: block;
  font-family: 'Dancing Script', cursive;
  font-size: 0.7em;
}

.hero-divider {
  display: flex;
  align-items: center;
  gap: 1rem;
  margin: 1rem 0;
  color: var(--rose-light);
}
.hero-divider::before,
.hero-divider::after {
  content: '';
  flex: 1;
  height: 1px;
  background: linear-gradient(90deg, transparent, var(--rose-light), transparent);
}

.hero-byline {
  font-family: 'Dancing Script', cursive;
  font-size: 1.4rem;
  color: var(--mauve);
  font-style: italic;
}

.hero-date-stamp {
  display: inline-block;
  margin-top: 1.2rem;
  padding: 0.4rem 1.2rem;
  border: 2px solid var(--rose-light);
  border-radius: 3px;
  font-family: 'Caveat', cursive;
  font-size: 1rem;
  color: var(--rose);
  transform: rotate(-1.5deg);
  position: relative;
  background: rgba(255,255,255,0.7);
}

.hero-corner {
  position: absolute;
  width: 20px; height: 20px;
  background: var(--gold-light);
  clip-path: polygon(0 0, 100% 0, 100% 100%);
  opacity: 0.7;
}
.hero-corner.tl { top: 0; left: 0; transform: rotate(180deg); }
.hero-corner.tr { top: 0; right: 0; transform: rotate(270deg); }
.hero-corner.bl { bottom: 0; left: 0; transform: rotate(90deg); }
.hero-corner.br { bottom: 0; right: 0; transform: rotate(0deg); }

.scroll-hint {
  position: absolute;
  bottom: 2rem;
  left: 50%;
  transform: translateX(-50%);
  text-align: center;
  z-index: 2;
  color: var(--mauve);
  font-family: 'Caveat', cursive;
  font-size: 1rem;
  animation: bounce 2s infinite;
}
@keyframes bounce {
  0%, 100% { transform: translateX(-50%) translateY(0); }
  50%       { transform: translateX(-50%) translateY(-8px); }
}
.scroll-hint svg { display: block; margin: 0 auto; }

/* ============================================
   SCRAPBOOK PAGES ‚Äî SHARED
   ============================================ */
.scrapbook-page {
  position: relative;
  padding: 4rem 2rem;
  overflow: hidden;
}

.scrapbook-page::before {
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 1;
}

/* Torn edge top */
.torn-top::after {
  content: '';
  position: absolute;
  top: -1px; left: 0; right: 0;
  height: 40px;
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 40' preserveAspectRatio='none'%3E%3Cpath d='M0,20 C120,5 240,35 360,15 C480,-5 600,30 720,20 C840,10 960,35 1080,18 C1200,1 1320,28 1440,15 L1440,0 L0,0 Z' fill='%23fdf6ee'/%3E%3C/svg%3E") no-repeat;
  background-size: 100% 100%;
}

/* Torn edge bottom */
.torn-bottom::before {
  content: '';
  position: absolute;
  bottom: -1px; left: 0; right: 0;
  height: 40px;
  background: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1440 40' preserveAspectRatio='none'%3E%3Cpath d='M0,15 C120,28 240,1 360,18 C480,35 600,10 720,20 C840,30 960,-5 1080,15 C1200,35 1320,5 1440,22 L1440,40 L0,40 Z' fill='%23fdf6ee'/%3E%3C/svg%3E") no-repeat;
  background-size: 100% 100%;
}

.section-tape {
  position: absolute;
  top: 15px; left: 50%;
  transform: translateX(-50%) rotate(-1deg);
  background: rgba(201,153,59,0.3);
  height: 22px;
  width: 80px;
  border-radius: 2px;
  z-index: 10;
}

.section-title {
  font-family: 'Playfair Display', serif;
  font-size: clamp(1.8rem, 4vw, 2.8rem);
  color: var(--rose-deep);
  text-align: center;
  font-style: italic;
  margin-bottom: 2.5rem;
  position: relative;
  z-index: 2;
}

.section-title::after {
  content: attr(data-subtitle);
  display: block;
  font-family: 'Caveat', cursive;
  font-size: 1rem;
  color: var(--mauve);
  font-style: normal;
  margin-top: 0.3rem;
}

/* ============================================
   LETTER / ENVELOPE SECTION
   ============================================ */
#letter-section {
  background: linear-gradient(135deg, #fdf0e8 0%, #f9e4ec 50%, #f5ecd8 100%);
  min-height: 80vh;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
}

.letter-doodles {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 1;
  overflow: hidden;
}

.doodle {
  position: absolute;
  font-size: 1.5rem;
  opacity: 0.18;
  animation: doodleDrift 8s ease-in-out infinite;
}
@keyframes doodleDrift {
  0%, 100% { transform: translateY(0) rotate(0deg); }
  50%       { transform: translateY(-10px) rotate(5deg); }
}

/* Envelope */
.envelope-container {
  position: relative;
  z-index: 2;
  cursor: pointer;
  perspective: 1000px;
}

.envelope {
  position: relative;
  width: min(380px, 90vw);
  height: 260px;
  transition: transform 0.3s ease;
}

.envelope:hover {
  transform: scale(1.03) translateY(-4px);
}

.env-body {
  position: absolute;
  inset: 0;
  background: linear-gradient(160deg, #d4453a 0%, #9b1234 100%);
  border-radius: 4px;
  box-shadow:
    0 8px 30px rgba(155,18,52,0.4),
    0 20px 60px rgba(0,0,0,0.2);
  overflow: hidden;
}

.env-body::after {
  content: '';
  position: absolute;
  inset: 0;
  background: linear-gradient(45deg, transparent 40%, rgba(255,255,255,0.08) 50%, transparent 60%);
}

.env-fold-bottom {
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 60%;
  background: linear-gradient(0deg, #7a0f22 0%, #b5182e 100%);
  clip-path: polygon(0 30%, 50% 0%, 100% 30%, 100% 100%, 0 100%);
}

.env-fold-top {
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 55%;
  background: linear-gradient(180deg, #9b1234 0%, #c72040 100%);
  clip-path: polygon(0 0, 50% 55%, 100% 0%);
  transform-origin: top center;
  transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  z-index: 5;
}

.env-fold-left {
  position: absolute;
  left: 0; top: 0; bottom: 0;
  width: 50%;
  background: linear-gradient(90deg, #8a1028 0%, #c01a35 100%);
  clip-path: polygon(0 0, 100% 50%, 0 100%);
}

.env-fold-right {
  position: absolute;
  right: 0; top: 0; bottom: 0;
  width: 50%;
  background: linear-gradient(270deg, #8a1028 0%, #c01a35 100%);
  clip-path: polygon(100% 0, 0 50%, 100% 100%);
}

.env-seal {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: 60px; height: 60px;
  background: radial-gradient(circle, var(--gold-light), var(--gold));
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1.5rem;
  box-shadow: 0 2px 10px rgba(0,0,0,0.3);
  z-index: 6;
  border: 3px solid rgba(255,255,255,0.3);
}

.env-click-hint {
  position: absolute;
  bottom: -2.5rem;
  left: 50%;
  transform: translateX(-50%);
  font-family: 'Caveat', cursive;
  font-size: 1.1rem;
  color: var(--mauve);
  white-space: nowrap;
  animation: pulse-hint 2s ease-in-out infinite;
}
@keyframes pulse-hint {
  0%, 100% { opacity: 0.7; }
  50%       { opacity: 1; }
}

/* Letter Paper */
.letter-paper {
  position: absolute;
  top: 10px; left: 10px; right: 10px;
  bottom: 10px;
  background: var(--paper);
  border-radius: 2px;
  padding: 1.5rem;
  transform: scaleY(0);
  transform-origin: top center;
  z-index: 3;
  overflow: hidden;
  display: none;
}

.letter-lines {
  position: absolute;
  inset: 0;
  background-image: repeating-linear-gradient(
    transparent,
    transparent 27px,
    rgba(155,18,52,0.08) 27px,
    rgba(155,18,52,0.08) 28px
  );
  pointer-events: none;
}

.letter-text {
  font-family: 'Dancing Script', cursive;
  font-size: clamp(0.9rem, 2.5vw, 1.1rem);
  line-height: 1.7;
  color: var(--ink);
  position: relative;
  z-index: 1;
}

.letter-text .salutation {
  font-size: 1.4em;
  color: var(--rose-deep);
  display: block;
  margin-bottom: 0.5rem;
}

.letter-text .signature {
  margin-top: 1rem;
  text-align: right;
  font-size: 1.2em;
  color: var(--rose-deep);
}

/* Full Letter Modal */
#letter-modal {
  position: fixed;
  inset: 0;
  z-index: 8888;
  display: none;
  align-items: center;
  justify-content: center;
  padding: 1rem;
}

.modal-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(26,10,18,0.85);
  backdrop-filter: blur(4px);
}

.letter-full {
  position: relative;
  background: var(--paper);
  max-width: 600px;
  width: 100%;
  max-height: 88vh;
  overflow-y: auto;
  border-radius: 4px;
  padding: 3rem 2.5rem;
  box-shadow: 0 30px 100px rgba(0,0,0,0.5);
  z-index: 1;
}

.letter-full::before {
  content: '';
  position: absolute;
  inset: 0;
  background-image: repeating-linear-gradient(
    transparent,
    transparent 29px,
    rgba(155,18,52,0.07) 29px,
    rgba(155,18,52,0.07) 30px
  );
  pointer-events: none;
}

.letter-full-margin {
  position: absolute;
  top: 0; bottom: 0;
  left: 3rem;
  width: 1px;
  background: rgba(232,37,74,0.2);
}

.letter-full-content {
  font-family: 'Dancing Script', cursive;
  font-size: clamp(1.1rem, 2.5vw, 1.3rem);
  line-height: 1.85;
  color: var(--ink);
  position: relative;
  z-index: 1;
}

.letter-full-content .lf-salutation {
  font-size: 1.5em;
  color: var(--rose-deep);
  display: block;
  margin-bottom: 1rem;
}

.letter-full-content .lf-signature {
  display: block;
  margin-top: 1.5rem;
  text-align: right;
  font-size: 1.3em;
  color: var(--rose-deep);
}

.letter-close {
  position: absolute;
  top: 1rem; right: 1rem;
  background: none;
  border: none;
  font-size: 1.5rem;
  cursor: pointer;
  color: var(--mauve);
  z-index: 2;
  transition: transform 0.2s;
}
.letter-close:hover { transform: rotate(90deg) scale(1.2); }

.letter-ribbon-deco {
  position: absolute;
  top: 0; left: 50%;
  transform: translateX(-50%);
  width: 3px;
  height: 30px;
  background: var(--rose);
  box-shadow: 0 0 8px var(--rose);
}

/* Rose petals floating */
.rose-petal {
  position: fixed;
  pointer-events: none;
  z-index: 8889;
  font-size: 1rem;
  animation: petalFall 4s ease-in forwards;
}
@keyframes petalFall {
  0%   { transform: translateY(-50px) rotate(0deg); opacity: 0; }
  10%  { opacity: 0.8; }
  100% { transform: translateY(110vh) rotate(720deg) translateX(60px); opacity: 0; }
}

/* ============================================
   PHOTO GALLERY
   ============================================ */
#gallery-section {
  background: linear-gradient(180deg, #f5e8ef 0%, #ede4d8 100%);
  min-height: 70vh;
  padding: 5rem 1rem;
}

.polaroid-grid {
  display: flex;
  flex-wrap: wrap;
  gap: 2rem;
  justify-content: center;
  max-width: 1000px;
  margin: 0 auto;
  position: relative;
  z-index: 2;
}

.polaroid {
  background: white;
  padding: 12px 12px 40px;
  box-shadow:
    0 4px 12px rgba(0,0,0,0.15),
    0 1px 3px rgba(0,0,0,0.08);
  width: min(220px, 44vw);
  transform: rotate(var(--rot, 0deg));
  transition: transform 0.3s ease, box-shadow 0.3s ease;
  cursor: pointer;
  position: relative;
}

.polaroid:nth-child(1) { --rot: -3deg; }
.polaroid:nth-child(2) { --rot: 2deg; }
.polaroid:nth-child(3) { --rot: -1.5deg; }
.polaroid:nth-child(4) { --rot: 3.5deg; }
.polaroid:nth-child(5) { --rot: -2.5deg; }
.polaroid:nth-child(6) { --rot: 1.5deg; }

.polaroid:hover {
  transform: rotate(0deg) scale(1.08) translateY(-8px);
  box-shadow: 0 20px 40px rgba(0,0,0,0.25);
  z-index: 10;
}

.polaroid img, .polaroid .photo-placeholder {
  width: 100%;
  aspect-ratio: 1;
  object-fit: cover;
  display: block;
}

.photo-placeholder {
  background: linear-gradient(135deg, var(--blush), var(--rose-light));
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 2.5rem;
  flex-direction: column;
  gap: 0.5rem;
}

.photo-placeholder span {
  font-family: 'Caveat', cursive;
  font-size: 0.75rem;
  color: var(--rose-deep);
  text-align: center;
  padding: 0 0.5rem;
}

.polaroid-caption {
  position: absolute;
  bottom: 8px;
  left: 0; right: 0;
  text-align: center;
  font-family: 'Caveat', cursive;
  font-size: 0.95rem;
  color: var(--mauve);
}

.polaroid-corner {
  position: absolute;
  width: 16px; height: 16px;
  background: rgba(201,153,59,0.5);
  clip-path: polygon(0 0, 100% 0, 100% 100%);
}
.polaroid-corner.pc-tl { top: 4px; left: 4px; transform: rotate(180deg); }
.polaroid-corner.pc-tr { top: 4px; right: 4px; transform: rotate(270deg); }
.polaroid-corner.pc-bl { bottom: 30px; left: 4px; transform: rotate(90deg); }
.polaroid-corner.pc-br { bottom: 30px; right: 4px; }

.polaroid-sticker {
  position: absolute;
  top: -12px; right: -12px;
  font-size: 1.4rem;
  transform: rotate(15deg);
  filter: drop-shadow(0 2px 3px rgba(0,0,0,0.2));
  transition: transform 0.2s;
  cursor: pointer;
  z-index: 5;
}
.polaroid-sticker:hover {
  transform: rotate(0deg) scale(1.3);
}

/* Lightbox */
#lightbox {
  position: fixed;
  inset: 0;
  z-index: 8000;
  display: none;
  align-items: center;
  justify-content: center;
  background: rgba(26,10,18,0.9);
}
.lightbox-img {
  max-width: 90vw;
  max-height: 85vh;
  border: 10px solid white;
  box-shadow: 0 20px 60px rgba(0,0,0,0.5);
  animation: zoomIn 0.3s ease;
}
@keyframes zoomIn {
  from { transform: scale(0.7); opacity: 0; }
  to   { transform: scale(1); opacity: 1; }
}
.lightbox-close {
  position: absolute;
  top: 1rem; right: 1rem;
  background: none; border: none;
  color: white; font-size: 2rem;
  cursor: pointer;
}

/* ============================================
   LOVE CALCULATOR
   ============================================ */
#calculator-section {
  background: linear-gradient(135deg, #fde8d0 0%, #f9d5e5 100%);
  padding: 5rem 1rem;
}

.calc-card {
  position: relative;
  background: white;
  max-width: 500px;
  margin: 0 auto;
  padding: 2.5rem;
  box-shadow: 0 8px 30px rgba(155,18,52,0.15);
  transform: rotate(-0.5deg);
  border: 1px solid rgba(201,153,59,0.2);
}

.calc-card::before {
  content: '';
  position: absolute;
  top: -1px; left: 0; right: 0;
  height: 6px;
  background: linear-gradient(90deg, var(--rose), var(--gold), var(--rose));
}

.calc-label {
  font-family: 'Caveat', cursive;
  font-size: 1.1rem;
  color: var(--mauve);
  display: block;
  margin-bottom: 0.3rem;
}

.calc-input {
  width: 100%;
  padding: 0.6rem 1rem;
  border: 2px solid var(--rose-light);
  border-radius: 4px;
  font-family: 'Dancing Script', cursive;
  font-size: 1.3rem;
  color: var(--ink);
  background: var(--paper);
  margin-bottom: 1rem;
  outline: none;
  transition: border-color 0.2s;
}
.calc-input:focus { border-color: var(--rose); }

.calc-btn {
  display: block;
  width: 100%;
  padding: 0.8rem;
  background: linear-gradient(135deg, var(--rose), var(--rose-deep));
  color: white;
  border: none;
  border-radius: 4px;
  font-family: 'Dancing Script', cursive;
  font-size: 1.3rem;
  cursor: pointer;
  transition: transform 0.2s, box-shadow 0.2s;
  box-shadow: 0 4px 15px rgba(232,37,74,0.3);
}
.calc-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(232,37,74,0.4);
}

.love-meter {
  margin-top: 1.5rem;
  display: none;
}

.meter-label {
  font-family: 'Dancing Script', cursive;
  font-size: 1.3rem;
  color: var(--rose-deep);
  text-align: center;
  margin-bottom: 0.6rem;
}

.meter-bar-outer {
  height: 28px;
  background: var(--blush);
  border-radius: 14px;
  overflow: hidden;
  border: 2px solid var(--rose-light);
  position: relative;
}

.meter-hearts {
  display: flex;
  align-items: center;
  height: 100%;
  padding: 0 4px;
  gap: 2px;
  transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
  background: linear-gradient(90deg, var(--rose-light), var(--rose));
  border-radius: 12px;
  min-width: 0;
}

.meter-result {
  text-align: center;
  font-family: 'Dancing Script', cursive;
  font-size: 1.4rem;
  color: var(--rose-deep);
  margin-top: 0.8rem;
  display: none;
}

/* Countdown */
.countdown-card {
  position: relative;
  background: linear-gradient(135deg, var(--rose-deep), var(--burgundy));
  color: white;
  max-width: 500px;
  margin: 2rem auto 0;
  padding: 2rem;
  border-radius: 4px;
  text-align: center;
  box-shadow: 0 8px 30px rgba(155,18,52,0.3);
  transform: rotate(0.5deg);
  overflow: hidden;
}
.countdown-card::before {
  content: '';
  position: absolute;
  inset: 0;
  background: repeating-linear-gradient(
    45deg,
    transparent,
    transparent 10px,
    rgba(255,255,255,0.02) 10px,
    rgba(255,255,255,0.02) 20px
  );
}

.countdown-title {
  font-family: 'Dancing Script', cursive;
  font-size: 1.4rem;
  margin-bottom: 1rem;
  color: var(--gold-light);
  position: relative;
}

.countdown-digits {
  display: flex;
  justify-content: center;
  gap: 1rem;
  flex-wrap: wrap;
  position: relative;
}

.cd-unit {
  text-align: center;
  min-width: 60px;
}

.cd-num {
  font-family: 'Playfair Display', serif;
  font-size: 2.2rem;
  font-weight: 700;
  color: var(--gold-light);
  display: block;
  text-shadow: 0 0 20px rgba(240,208,128,0.5);
  animation: tickPulse 1s ease-in-out infinite;
}
@keyframes tickPulse {
  0%, 100% { transform: scale(1); }
  50%       { transform: scale(1.05); }
}

.cd-label {
  font-family: 'Caveat', cursive;
  font-size: 0.8rem;
  color: rgba(255,255,255,0.6);
  text-transform: uppercase;
  letter-spacing: 0.1em;
}

.courting-counter {
  margin-top: 1.5rem;
  padding-top: 1.5rem;
  border-top: 1px solid rgba(255,255,255,0.15);
  font-family: 'Dancing Script', cursive;
  font-size: 1.1rem;
  color: var(--rose-light);
  position: relative;
}

.courting-days {
  font-size: 2rem;
  color: var(--gold-light);
  font-family: 'Playfair Display', serif;
}

/* ============================================
   WHY I LOVE YOU
   ============================================ */
#love-list-section {
  background: linear-gradient(160deg, #fdf6ee 0%, #f8e4ec 100%);
  padding: 5rem 1rem;
}

.love-list-container {
  max-width: 700px;
  margin: 0 auto;
  position: relative;
  z-index: 2;
}

.love-item {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
  margin-bottom: 1.5rem;
  padding: 1.2rem 1.5rem;
  background: white;
  border-left: 4px solid var(--rose);
  box-shadow: 3px 3px 12px rgba(155,18,52,0.1);
  transform: translateX(-30px);
  opacity: 0;
  transition: transform 0.4s ease, opacity 0.4s ease;
  position: relative;
}

.love-item.visible {
  transform: translateX(0);
  opacity: 1;
}

.love-number {
  font-family: 'Playfair Display', serif;
  font-size: 2rem;
  color: var(--rose-light);
  font-style: italic;
  line-height: 1;
  min-width: 2rem;
  text-align: center;
}

.love-text-wrap {
  flex: 1;
}

.love-heading {
  font-family: 'Playfair Display', serif;
  font-size: 1.1rem;
  color: var(--rose-deep);
  margin-bottom: 0.2rem;
  font-style: italic;
}

.love-body {
  font-family: 'Caveat', cursive;
  font-size: 1rem;
  color: var(--ink);
  line-height: 1.5;
}

.love-emoji {
  font-size: 1.4rem;
}

.love-doodle-right {
  position: absolute;
  right: 1rem; top: 50%;
  transform: translateY(-50%);
  font-size: 1.2rem;
  opacity: 0.3;
}

/* ============================================
   CHAINED HEART / SPICY UNLOCK
   ============================================ */
#unlock-section {
  background: linear-gradient(160deg, #1a0a12 0%, #2d0f1e 50%, #1a0a12 100%);
  min-height: 80vh;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 4rem 1rem;
  overflow: hidden;
  position: relative;
}

.unlock-stars {
  position: absolute;
  inset: 0;
  pointer-events: none;
}

.star-dot {
  position: absolute;
  width: 2px; height: 2px;
  background: white;
  border-radius: 50%;
  animation: twinkle var(--dur, 3s) ease-in-out var(--del, 0s) infinite;
}
@keyframes twinkle {
  0%, 100% { opacity: 0.1; transform: scale(1); }
  50%       { opacity: 0.9; transform: scale(1.5); }
}

.unlock-title {
  font-family: 'Playfair Display', serif;
  font-size: clamp(1.5rem, 4vw, 2.5rem);
  color: var(--gold-light);
  text-align: center;
  font-style: italic;
  margin-bottom: 0.5rem;
  text-shadow: 0 0 30px rgba(240,208,128,0.4);
  position: relative;
  z-index: 2;
}

.unlock-subtitle {
  font-family: 'Caveat', cursive;
  font-size: 1.1rem;
  color: var(--mauve);
  text-align: center;
  margin-bottom: 3rem;
  position: relative;
  z-index: 2;
}

.chained-heart-wrap {
  position: relative;
  z-index: 2;
  cursor: pointer;
}

.chain-svg {
  position: absolute;
  top: 50%; left: 50%;
  transform: translate(-50%, -50%);
  width: 220px; height: 220px;
  animation: chainRattle 3s ease-in-out infinite;
}
@keyframes chainRattle {
  0%, 90%, 100% { transform: translate(-50%, -50%) rotate(0deg); }
  92%            { transform: translate(-50%, -50%) rotate(-2deg); }
  94%            { transform: translate(-50%, -50%) rotate(2deg); }
  96%            { transform: translate(-50%, -50%) rotate(-1deg); }
  98%            { transform: translate(-50%, -50%) rotate(1deg); }
}

.heart-main-svg {
  display: block;
  width: 140px; height: 140px;
  filter: drop-shadow(0 0 30px rgba(232,37,74,0.6));
  animation: heartPulse 2s ease-in-out infinite;
}
@keyframes heartPulse {
  0%, 100% { transform: scale(1); }
  50%       { transform: scale(1.06); }
}

.lock-icon {
  position: absolute;
  bottom: -8px; left: 50%;
  transform: translateX(-50%);
  font-size: 1.8rem;
  filter: drop-shadow(0 2px 4px rgba(0,0,0,0.5));
}

.unlock-hint {
  margin-top: 2rem;
  font-family: 'Caveat', cursive;
  font-size: 1.1rem;
  color: rgba(240,208,128,0.6);
  text-align: center;
  position: relative;
  z-index: 2;
  animation: pulse-hint 3s ease-in-out infinite;
}

/* Password Modal */
#pw-modal {
  position: fixed;
  inset: 0;
  z-index: 9000;
  display: none;
  align-items: center;
  justify-content: center;
}

.pw-backdrop {
  position: absolute;
  inset: 0;
  background: rgba(0,0,0,0.8);
}

.pw-box {
  position: relative;
  z-index: 1;
  background: linear-gradient(160deg, #2d0f1e, #1a0a12);
  border: 2px solid var(--gold);
  padding: 2.5rem;
  text-align: center;
  width: min(380px, 90vw);
  box-shadow: 0 0 60px rgba(201,153,59,0.2), 0 30px 80px rgba(0,0,0,0.6);
}

.pw-title {
  font-family: 'Playfair Display', serif;
  font-size: 1.6rem;
  color: var(--gold-light);
  font-style: italic;
  margin-bottom: 0.5rem;
}

.pw-subtitle {
  font-family: 'Caveat', cursive;
  font-size: 1rem;
  color: var(--mauve);
  margin-bottom: 1.5rem;
}

.pw-input {
  width: 100%;
  padding: 0.8rem;
  background: rgba(255,255,255,0.05);
  border: 1px solid var(--mauve);
  color: white;
  font-family: 'Dancing Script', cursive;
  font-size: 1.3rem;
  text-align: center;
  letter-spacing: 0.2em;
  outline: none;
  margin-bottom: 1rem;
  border-radius: 2px;
  transition: border-color 0.2s;
}
.pw-input:focus { border-color: var(--gold); }

.pw-btn {
  padding: 0.7rem 2.5rem;
  background: linear-gradient(135deg, var(--gold), var(--gold-light));
  color: var(--midnight);
  border: none;
  font-family: 'Dancing Script', cursive;
  font-size: 1.2rem;
  cursor: pointer;
  border-radius: 2px;
  transition: transform 0.2s;
  font-weight: 700;
}
.pw-btn:hover { transform: scale(1.05); }

.pw-error {
  color: var(--rose-light);
  font-family: 'Caveat', cursive;
  font-size: 0.9rem;
  margin-top: 0.5rem;
  display: none;
  animation: shake 0.4s ease;
}
@keyframes shake {
  0%, 100% { transform: translateX(0); }
  25%       { transform: translateX(-6px); }
  75%       { transform: translateX(6px); }
}

.pw-close {
  position: absolute;
  top: 0.7rem; right: 0.8rem;
  background: none; border: none;
  color: var(--mauve); font-size: 1.3rem;
  cursor: pointer;
}

/* ============================================
   SPICY GALLERY (Locked)
   ============================================ */
#spicy-section {
  background: linear-gradient(160deg, #0d0006 0%, #1a0a12 50%, #0d0006 100%);
  display: none;
  padding: 5rem 1rem;
  position: relative;
  overflow: hidden;
}

#spicy-canvas {
  position: absolute;
  inset: 0;
  width: 100%; height: 100%;
}

.spicy-title {
  font-family: 'Playfair Display', serif;
  font-size: clamp(2rem, 5vw, 3.5rem);
  color: var(--gold-light);
  text-align: center;
  font-style: italic;
  margin-bottom: 0.5rem;
  position: relative;
  z-index: 2;
  text-shadow: 0 0 40px rgba(240,208,128,0.5);
}

.spicy-subtitle {
  font-family: 'Caveat', cursive;
  font-size: 1.2rem;
  color: var(--rose-light);
  text-align: center;
  margin-bottom: 3rem;
  position: relative;
  z-index: 2;
}

.spicy-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
  gap: 1.5rem;
  max-width: 900px;
  margin: 0 auto;
  position: relative;
  z-index: 2;
}

.spicy-item {
  position: relative;
  background: white;
  padding: 8px 8px 30px;
  box-shadow: 0 8px 30px rgba(0,0,0,0.5);
  transform: scale(0) rotate(var(--sr, 0deg));
  opacity: 0;
  transition: transform 0.3s ease, box-shadow 0.3s ease;
}

.spicy-item:hover {
  transform: rotate(0deg) scale(1.05) translateY(-5px) !important;
  box-shadow: 0 20px 50px rgba(201,153,59,0.4);
  z-index: 5;
}

.spicy-photo-placeholder {
  width: 100%;
  aspect-ratio: 3/4;
  background: linear-gradient(135deg, #2d0f1e, #5a1a30);
  display: flex;
  align-items: center;
  justify-content: center;
  flex-direction: column;
  gap: 0.5rem;
}

.spicy-photo-placeholder span {
  color: var(--rose-light);
  font-family: 'Caveat', cursive;
  font-size: 0.8rem;
  text-align: center;
  padding: 0 0.5rem;
}

.spicy-caption {
  position: absolute;
  bottom: 6px; left: 0; right: 0;
  text-align: center;
  font-family: 'Dancing Script', cursive;
  font-size: 0.9rem;
  color: var(--rose-deep);
}

/* Curtain effect */
.curtain-left, .curtain-right {
  position: fixed;
  top: 0; bottom: 0;
  width: 51%;
  background: linear-gradient(90deg, #0d0006, #2d0f1e);
  z-index: 8500;
  transition: transform 1.5s cubic-bezier(0.4, 0, 0.2, 1);
}
.curtain-left  { left: 0; transform-origin: left center; }
.curtain-right { right: 0; transform-origin: right center; }
.curtain-left.open  { transform: scaleX(0); }
.curtain-right.open { transform: scaleX(0); }

/* ============================================
   INTERACTIVE FOOTER
   ============================================ */
#footer-section {
  background: linear-gradient(135deg, #f5e8ef 0%, #ede4d8 100%);
  padding: 4rem 1rem;
  text-align: center;
  position: relative;
}

.surprise-btn {
  display: inline-block;
  padding: 1rem 2.5rem;
  background: linear-gradient(135deg, var(--rose), var(--rose-deep));
  color: white;
  border: none;
  font-family: 'Dancing Script', cursive;
  font-size: 1.4rem;
  cursor: pointer;
  box-shadow: 0 6px 20px rgba(232,37,74,0.35);
  transition: transform 0.2s, box-shadow 0.2s;
  position: relative;
  overflow: hidden;
  border-radius: 3px;
}
.surprise-btn:hover {
  transform: translateY(-3px);
  box-shadow: 0 10px 30px rgba(232,37,74,0.45);
}

.surprise-message {
  display: none;
  margin-top: 2rem;
  font-family: 'Dancing Script', cursive;
  font-size: clamp(1.2rem, 3vw, 1.6rem);
  color: var(--rose-deep);
  max-width: 500px;
  margin-left: auto;
  margin-right: auto;
  line-height: 1.6;
}

.footer-hearts {
  margin-top: 2rem;
  font-size: 1.5rem;
  letter-spacing: 0.5rem;
  animation: heartbeat 1.5s ease-in-out infinite;
}
@keyframes heartbeat {
  0%, 100% { transform: scale(1); }
  14%       { transform: scale(1.1); }
  28%       { transform: scale(1); }
  42%       { transform: scale(1.1); }
  70%       { transform: scale(1); }
}

.footer-sig {
  margin-top: 1.5rem;
  font-family: 'Playfair Display', serif;
  font-size: 1rem;
  color: var(--mauve);
  font-style: italic;
}

/* ============================================
   CONFETTI
   ============================================ */
.confetti-piece {
  position: fixed;
  width: 8px; height: 8px;
  border-radius: 2px;
  pointer-events: none;
  z-index: 99990;
  animation: confettiFall var(--dur, 3s) ease-in var(--del, 0s) forwards;
  opacity: 0;
}
@keyframes confettiFall {
  0%   { transform: translateY(-20px) rotate(0deg) translateX(0); opacity: 1; }
  100% { transform: translateY(100vh) rotate(720deg) translateX(var(--dx, 50px)); opacity: 0; }
}

/* ============================================
   FLOATING 3D HEART CURSOR FOLLOWER
   ============================================ */
#floating-heart {
  position: fixed;
  pointer-events: none;
  z-index: 9990;
  width: 40px; height: 40px;
  transition: transform 0.4s ease;
  display: none;
}

/* ============================================
   NAV
   ============================================ */
.site-nav {
  position: fixed;
  top: 0; left: 0; right: 0;
  z-index: 500;
  display: flex;
  align-items: center;
  justify-content: center;
  gap: 1.5rem;
  padding: 0.8rem;
  background: rgba(253,246,238,0.85);
  backdrop-filter: blur(8px);
  border-bottom: 1px solid rgba(232,37,74,0.1);
  transform: translateY(-100%);
  transition: transform 0.4s ease;
}
.site-nav.visible { transform: translateY(0); }

.nav-link {
  font-family: 'Caveat', cursive;
  font-size: 1rem;
  color: var(--rose-deep);
  text-decoration: none;
  padding: 0.2rem 0.5rem;
  transition: color 0.2s;
  position: relative;
}
.nav-link::after {
  content: '';
  position: absolute;
  bottom: 0; left: 0; right: 0;
  height: 1px;
  background: var(--rose);
  transform: scaleX(0);
  transition: transform 0.2s;
}
.nav-link:hover { color: var(--rose); }
.nav-link:hover::after { transform: scaleX(1); }

/* ============================================
   RESPONSIVE
   ============================================ */
@media (max-width: 600px) {
  .polaroid-grid { gap: 1rem; }
  .polaroid { width: min(160px, 44vw); }
  .cover-frame { padding: 1.5rem; }
  .countdown-digits { gap: 0.5rem; }
  .cd-num { font-size: 1.6rem; }
  .spicy-grid { grid-template-columns: repeat(2, 1fr); }
}

@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
    animation-duration: 0.01ms !important;
    transition-duration: 0.01ms !important;
  }
}
</style>
</head>
<body>

<!-- Custom cursor -->
<div id="cursor" aria-hidden="true"></div>
<div id="cursor-trail" aria-hidden="true"></div>

<!-- ============================================================
     LOADING SCREEN
     ============================================================ -->
<div id="loading-screen" role="status" aria-label="Loading">
  <canvas id="loading-canvas"></canvas>

  <!-- Floating hearts -->
  <div id="loader-hearts" aria-hidden="true"></div>

  <div class="loading-content">
    <div class="loading-initials" id="load-initials">A ‚ô• B</div>
    <div class="loading-subtitle" id="load-subtitle">A Love Story Unfolding...</div>
    <div class="loading-date" id="load-date">Since late November 2025 ‚ú¶</div>
    <div class="progress-wrapper" id="load-progress">
      <div class="progress-label">üìñ Opening our scrapbook...</div>
      <div class="progress-bar-outer">
        <div class="progress-bar-inner" id="progress-fill"></div>
      </div>
      <div class="progress-pages">
        <span>cover</span><span>chapter i</span><span>chapter ii</span><span>our story</span>
      </div>
    </div>
  </div>
</div>

<!-- ============================================================
     MAIN SITE
     ============================================================ -->
<div id="main-site">

  <!-- Navigation -->
  <nav class="site-nav" id="site-nav" aria-label="Site navigation">
    <a class="nav-link" href="#hero">Cover</a>
    <a class="nav-link" href="#letter-section">Letter</a>
    <a class="nav-link" href="#gallery-section">Gallery</a>
    <a class="nav-link" href="#calculator-section">Calculator</a>
    <a class="nav-link" href="#love-list-section">Why You</a>
    <a class="nav-link" href="#unlock-section">‚ô• Secret</a>
  </nav>

  <!-- ====== HERO ====== -->
  <section id="hero" aria-label="Cover page">
    <canvas id="hero-canvas" aria-hidden="true"></canvas>

    <div class="hero-scrapbook">
      <div class="cover-frame" style="position:relative;">
        <div class="cover-tape tape-top-left" aria-hidden="true"></div>
        <div class="cover-tape tape-top-right" aria-hidden="true"></div>
        <div class="cover-ribbon" aria-hidden="true"></div>
        <div class="hero-corner tl" aria-hidden="true"></div>
        <div class="hero-corner tr" aria-hidden="true"></div>
        <div class="hero-corner bl" aria-hidden="true"></div>
        <div class="hero-corner br" aria-hidden="true"></div>

        <div class="hero-eyelet" aria-hidden="true">
          <span></span><span></span><span></span>
        </div>

        <h1 class="hero-title">
          Our Valentine's
          <em id="hero-subtitle-name">Scrapbook</em>
        </h1>

        <div class="hero-divider" aria-hidden="true">‚ô•</div>

        <p class="hero-byline" id="hero-byline">
          A story of pursuit, confession & mutual love
        </p>

        <div class="hero-date-stamp" aria-label="Since late November 2025">
          Est. Late November 2025 ‚ú¶
        </div>
      </div>
    </div>

    <div class="scroll-hint" aria-hidden="true">
      <span style="font-family:'Caveat';font-size:0.9rem;">turn the page</span>
      <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M12 5v14M5 12l7 7 7-7"/>
      </svg>
    </div>
  </section>

  <!-- ====== LETTER ====== -->
  <section id="letter-section" class="scrapbook-page torn-top torn-bottom" aria-label="Love letter">
    <div class="section-tape" aria-hidden="true"></div>

    <!-- Doodles -->
    <div class="letter-doodles" aria-hidden="true">
      <span class="doodle" style="top:8%;left:5%;--delay:0s">üåπ</span>
      <span class="doodle" style="top:20%;right:8%;--delay:1s">‚úø</span>
      <span class="doodle" style="bottom:15%;left:10%;--delay:2s">üí´</span>
      <span class="doodle" style="bottom:25%;right:6%;--delay:0.5s">üéÄ</span>
      <span class="doodle" style="top:50%;left:2%;--delay:1.5s">‚ô°</span>
      <span class="doodle" style="top:40%;right:3%;--delay:3s">üå∏</span>
    </div>

    <h2 class="section-title" data-subtitle="click the envelope to open">
      A Letter From My Heart
    </h2>

    <div class="envelope-container" id="envelope-container" role="button" aria-label="Click to open love letter" tabindex="0">
      <div class="envelope" id="envelope">
        <div class="env-body">
          <div class="env-fold-left" aria-hidden="true"></div>
          <div class="env-fold-right" aria-hidden="true"></div>
          <div class="env-fold-bottom" aria-hidden="true"></div>
          <div class="env-fold-top" id="env-flap" aria-hidden="true"></div>
          <div class="env-seal" aria-hidden="true">üíå</div>
        </div>
      </div>
      <div class="env-click-hint" aria-hidden="true">‚ú¶ tap to open ‚ú¶</div>
    </div>
  </section>

  <!-- Letter Modal -->
  <div id="letter-modal" role="dialog" aria-modal="true" aria-label="Love letter" style="display:none;">
    <div class="modal-backdrop" id="letter-backdrop"></div>
    <div class="letter-full" id="letter-paper-full">
      <div class="letter-ribbon-deco" aria-hidden="true"></div>
      <div class="letter-full-margin" aria-hidden="true"></div>
      <button class="letter-close" id="letter-close" aria-label="Close letter">‚úï</button>
      <div class="letter-full-content" id="letter-text-typed">
        <!-- Typed via JS -->
      </div>
    </div>
  </div>

  <!-- ====== GALLERY ====== -->
  <section id="gallery-section" class="scrapbook-page torn-top" aria-label="Photo gallery">
    <div class="section-tape" aria-hidden="true"></div>
    <h2 class="section-title" data-subtitle="my most treasured memories of you">
      My Favorite Pages of You
    </h2>

    <div class="polaroid-grid" id="polaroid-grid" role="list">
      <!-- Generated by JS -->
    </div>
  </section>

  <!-- Lightbox -->
  <div id="lightbox" role="dialog" aria-modal="true" aria-label="Photo viewer">
    <button class="lightbox-close" id="lightbox-close" aria-label="Close photo">‚úï</button>
    <div id="lightbox-img-wrap"></div>
  </div>

  <!-- ====== CALCULATOR ====== -->
  <section id="calculator-section" class="scrapbook-page torn-top torn-bottom" aria-label="Love calculator">
    <div class="section-tape" aria-hidden="true"></div>
    <h2 class="section-title" data-subtitle="the math of our hearts">Love Calculator</h2>

    <div class="calc-card" role="form" aria-label="Love calculator form">
      <label class="calc-label" for="name1">Your name, my love:</label>
      <input class="calc-input" id="name1" type="text" placeholder="Your name..." aria-required="true">

      <label class="calc-label" for="name2">My name:</label>
      <input class="calc-input" id="name2" type="text" placeholder="My name..." aria-required="true">

      <button class="calc-btn" id="calc-btn" type="button">
        Calculate Our Love ‚ô•
      </button>

      <div class="love-meter" id="love-meter" aria-live="polite">
        <div class="meter-label" id="meter-label">Compatibility: <strong id="compat-pct">0</strong>%</div>
        <div class="meter-bar-outer" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100">
          <div class="meter-hearts" id="meter-fill"></div>
        </div>
        <div class="meter-result" id="meter-result"></div>
      </div>
    </div>

    <div class="countdown-card" aria-live="polite">
      <div class="countdown-title">üíù Valentine's Day Countdown</div>
      <div class="countdown-digits">
        <div class="cd-unit"><span class="cd-num" id="cd-days">--</span><span class="cd-label">days</span></div>
        <div class="cd-unit"><span class="cd-num" id="cd-hours">--</span><span class="cd-label">hours</span></div>
        <div class="cd-unit"><span class="cd-num" id="cd-mins">--</span><span class="cd-label">mins</span></div>
        <div class="cd-unit"><span class="cd-num" id="cd-secs">--</span><span class="cd-label">secs</span></div>
      </div>
      <div class="courting-counter">
        Days I've been yours:<br>
        <span class="courting-days" id="courting-days">--</span> days of love & pursuit
      </div>
    </div>
  </section>

  <!-- ====== WHY I LOVE YOU ====== -->
  <section id="love-list-section" class="scrapbook-page torn-top" aria-label="Why I love you">
    <div class="section-tape" aria-hidden="true"></div>
    <h2 class="section-title" data-subtitle="the endless list">Why I Love You</h2>

    <div class="love-list-container" id="love-list">
      <!-- Generated by JS -->
    </div>
  </section>

  <!-- ====== CHAINED HEART ====== -->
  <section id="unlock-section" aria-label="Secret section">
    <div class="unlock-stars" id="unlock-stars" aria-hidden="true"></div>

    <h2 class="unlock-title">Something Hidden Just For You</h2>
    <p class="unlock-subtitle">A secret page ‚Äî if you dare unlock it üîê</p>

    <div class="chained-heart-wrap" id="heart-lock-btn" role="button" tabindex="0" aria-label="Click to unlock secret gallery">
      <svg class="chain-svg" viewBox="0 0 220 220" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <!-- Chain circle -->
        <circle cx="110" cy="110" r="100" stroke="#c9993b" stroke-width="2" stroke-dasharray="6 8" opacity="0.4"/>
        <!-- Chain links -->
        <g stroke="#c9993b" stroke-width="3" fill="none" opacity="0.7">
          <ellipse cx="110" cy="8" rx="8" ry="5" transform="rotate(0 110 8)"/>
          <ellipse cx="178" cy="35" rx="8" ry="5" transform="rotate(60 178 35)"/>
          <ellipse cx="210" cy="108" rx="8" ry="5" transform="rotate(90 210 108)"/>
          <ellipse cx="184" cy="182" rx="8" ry="5" transform="rotate(120 184 182)"/>
          <ellipse cx="110" cy="212" rx="8" ry="5" transform="rotate(0 110 212)"/>
          <ellipse cx="36" cy="182" rx="8" ry="5" transform="rotate(60 36 182)"/>
          <ellipse cx="10" cy="108" rx="8" ry="5" transform="rotate(90 10 108)"/>
          <ellipse cx="42" cy="35" rx="8" ry="5" transform="rotate(120 42 35)"/>
        </g>
      </svg>

      <!-- Heart SVG -->
      <svg class="heart-main-svg" viewBox="0 0 140 130" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <defs>
          <radialGradient id="hg" cx="50%" cy="40%" r="60%">
            <stop offset="0%" stop-color="#f05070"/>
            <stop offset="100%" stop-color="#7a0f22"/>
          </radialGradient>
          <filter id="hglow">
            <feGaussianBlur stdDeviation="3" result="blur"/>
            <feMerge><feMergeNode in="blur"/><feMergeNode in="SourceGraphic"/></feMerge>
          </filter>
        </defs>
        <path d="M70,118 C70,118 10,80 10,40 C10,18 28,8 45,8 C57,8 68,16 70,22 C72,16 83,8 95,8 C112,8 130,18 130,40 C130,80 70,118 70,118 Z"
              fill="url(#hg)" filter="url(#hglow)"/>
        <path d="M45,28 C38,28 32,34 32,40" stroke="rgba(255,255,255,0.3)" stroke-width="3" stroke-linecap="round" fill="none"/>
      </svg>

      <div class="lock-icon" aria-hidden="true">üîí</div>
    </div>

    <p class="unlock-hint">‚ú¶ click to unlock ‚ú¶</p>
  </section>

  <!-- Password Modal -->
  <div id="pw-modal" role="dialog" aria-modal="true" aria-label="Enter password" style="display:none;">
    <div class="pw-backdrop" id="pw-backdrop"></div>
    <div class="pw-box">
      <button class="pw-close" id="pw-close" aria-label="Close">‚úï</button>
      <div class="pw-title">üîê Password Required</div>
      <div class="pw-subtitle">Whisper the magic word to unlock our secret...</div>
      <input class="pw-input" id="pw-input" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" aria-label="Password">
      <br>
      <button class="pw-btn" id="pw-submit">Unlock ‚ô•</button>
      <div class="pw-error" id="pw-error">‚ùå Hmm, that's not the right password, love...</div>
    </div>
  </div>

  <!-- Curtains -->
  <div class="curtain-left" id="curtain-left" aria-hidden="true"></div>
  <div class="curtain-right" id="curtain-right" aria-hidden="true"></div>

  <!-- ====== SPICY GALLERY ====== -->
  <section id="spicy-section" aria-label="Secret gallery" style="display:none;">
    <canvas id="spicy-canvas" aria-hidden="true"></canvas>
    <h2 class="spicy-title">The Hidden Side of Me ‚ú¶</h2>
    <p class="spicy-subtitle">Only for your eyes, my love üî•</p>

    <div class="spicy-grid" id="spicy-grid">
      <!-- Generated by JS -->
    </div>
  </section>

  <!-- ====== FOOTER ====== -->
  <section id="footer-section" aria-label="Surprise message">
    <h2 class="section-title" style="margin-bottom:1.5rem;">One More Thing...</h2>
    <button class="surprise-btn" id="surprise-btn" type="button">
      ‚ú® Tap For a Surprise ‚ú®
    </button>
    <div class="surprise-message" id="surprise-message" aria-live="polite" role="region">
      <!-- Generated by JS -->
    </div>
    <div class="footer-hearts" aria-hidden="true">‚ô• ‚ô° ‚ô• ‚ô° ‚ô•</div>
    <p class="footer-sig" aria-label="With all my love, always">
      ‚Äî with all my love, always ‚ú¶
    </p>
  </section>

</div><!-- /#main-site -->

<!-- ============================================================
     JAVASCRIPT
     ============================================================ -->
<script>
/* ============================================================
   CONFIGURATION ‚Äî EDIT THESE!
   ============================================================ */
const CONFIG = {
  // Names
  partnerName:  "Zoeh",         // <-- Replace with his name
  myName:       "Jay",           // <-- Replace with your name
  initials:     "J ‚ô• Z",          // <-- Replace with your initials

  // Date when courtship began (end of November 2025)
  courtshipStart: new Date("2025-11-28"),

  // Valentine's Day target
  valentinesDay: new Date("2026-02-14"),

  // Password for spicy gallery
  spicyPassword: "loveunlocks",

  // Letter content (customize freely)
  letterText: `My dearest love,

Ever since that fateful end of November 2025, when I first gathered the courage to make my move ‚Äî to let you know that you had taken up permanent residence in my heart ‚Äî nothing has been quite the same.

I remember how I pursued you with everything I had. Every little moment, every stolen glance, every message sent with a racing heart. You were worth every bit of the chase.

And then came the confession. When the air between us finally cleared and we both admitted what we felt ‚Äî that was the moment our story truly began. Not as pursuer and pursued, but as two people, head over heels, reaching for each other.

You have this way about you that disarms me completely. Your playfulness, your brightness, your warmth ‚Äî they became the things I looked forward to most each day.

This Valentine's, I want you to know: the pursuit has turned into devotion. Every day since November has only deepened what I feel for you.

Thank you for letting me love you.
Thank you for loving me back.`,

  // Gallery photos (replace URLs with personal photos)
  galleryPhotos: [
    { label: "that smile üíï", emoji: "üå∏" },
    { label: "my sunshine ‚òÄÔ∏è", emoji: "üå∑" },
    { label: "forever mine üíñ", emoji: "‚ú®" },
    { label: "late night talks üåô", emoji: "ü´ß" },
    { label: "you & me üí´", emoji: "üéÄ" },
    { label: "always ‚ôæÔ∏è", emoji: "üåπ" },
  ],

  // Spicy gallery labels
  spicyPhotos: [
    { label: "the real me üòà", emoji: "üñ§" },
    { label: "my bold side üí™", emoji: "üî•" },
    { label: "just for you üîê", emoji: "üíã" },
    { label: "strength & soul", emoji: "‚ö°" },
    { label: "yours truly üíç", emoji: "ü•Ä" },
    { label: "all of me ü§ç", emoji: "üíØ" },
  ],

  // Why I love you list
  loveList: [
    {
      heading: "Your playful energy",
      body: "The way you laugh, tease, and light up a room ‚Äî it made me fall before I even knew what was happening.",
      emoji: "‚ú®"
    },
    {
      heading: "The courage you showed",
      body: "You met my pursuit with honesty. That confession took bravery, and I love you for it every single day.",
      emoji: "ü¶ã"
    },
    {
      heading: "How you make me feel grounded",
      body: "In my arms, or even just in my thoughts, there's a steadiness I've never known before. You did that.",
      emoji: "üåø"
    },
    {
      heading: "Your softness",
      body: "Underneath all the charm and wit, you have a tender heart ‚Äî and you trust me with it. That means everything.",
      emoji: "üå∏"
    },
    {
      heading: "The way you inspire me to be better",
      body: "Since November, I've wanted to be more ‚Äî more present, more caring, more worthy of you.",
      emoji: "üí™"
    },
    {
      heading: "Your whole, beautiful self",
      body: "Every side of you ‚Äî playful, pensive, bold, shy ‚Äî I want to know them all. And I'm not done learning.",
      emoji: "üíñ"
    },
  ],

  // Surprise messages (one chosen randomly)
  surpriseMessages: [
    "Happy Valentine's Day, my love. From the end of November until the end of forever ‚Äî I choose you, every day. üíï",
    "If I could go back and choose the day I started pursuing you all over again ‚Äî I'd choose it a thousand times. üåπ",
    "You are every love song I've ever heard finally making sense. Happy Valentine's Day. ‚ô•",
  ],
};

/* ============================================================
   CURSOR
   ============================================================ */
const cursor = document.getElementById('cursor');
const cursorTrail = document.getElementById('cursor-trail');
let mx = 0, my = 0;

document.addEventListener('mousemove', e => {
  mx = e.clientX; my = e.clientY;
  cursor.style.left = mx + 'px';
  cursor.style.top  = my + 'px';
  setTimeout(() => {
    cursorTrail.style.left = mx + 'px';
    cursorTrail.style.top  = my + 'px';
  }, 80);
});

document.addEventListener('mousedown', () => {
  cursor.style.width = '24px';
  cursor.style.height = '24px';
});
document.addEventListener('mouseup', () => {
  cursor.style.width = '18px';
  cursor.style.height = '18px';
});

/* ============================================================
   LOADING SCREEN ‚Äî Three.js particles + GSAP
   ============================================================ */
(function initLoader() {
  // Three.js heart particles on loading canvas
  const lCanvas = document.getElementById('loading-canvas');
  const renderer = new THREE.WebGLRenderer({ canvas: lCanvas, alpha: true, antialias: true });
  renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
  renderer.setSize(window.innerWidth, window.innerHeight);

  const scene  = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
  camera.position.z = 30;

  // Heart shape
  const heartShape = new THREE.Shape();
  heartShape.moveTo(0, 0);
  heartShape.bezierCurveTo(0, -3, -5, -3, -5, 0);
  heartShape.bezierCurveTo(-5, 3, 0, 6, 0, 9);
  heartShape.bezierCurveTo(0, 6, 5, 3, 5, 0);
  heartShape.bezierCurveTo(5, -3, 0, -3, 0, 0);

  const heartGeo = new THREE.ShapeGeometry(heartShape);
  const particles = [];
  const particleCount = 60;

  for (let i = 0; i < particleCount; i++) {
    const size = Math.random() * 0.6 + 0.1;
    const mat  = new THREE.MeshBasicMaterial({
      color: new THREE.Color().setHSL(Math.random() * 0.08 + 0.95, 0.8, 0.5 + Math.random() * 0.3),
      transparent: true,
      opacity: Math.random() * 0.7 + 0.2,
    });
    const mesh = new THREE.Mesh(heartGeo, mat);
    mesh.scale.set(size, size, size);
    mesh.position.set(
      (Math.random() - 0.5) * 60,
      (Math.random() - 0.5) * 40,
      (Math.random() - 0.5) * 20
    );
    mesh.rotation.z = Math.PI;
    mesh.userData = {
      vx: (Math.random() - 0.5) * 0.02,
      vy: Math.random() * 0.03 + 0.01,
      vr: (Math.random() - 0.5) * 0.01,
    };
    scene.add(mesh);
    particles.push(mesh);
  }

  let animRunning = true;
  function animateLoader() {
    if (!animRunning) return;
    requestAnimationFrame(animateLoader);
    particles.forEach(p => {
      p.position.x += p.userData.vx;
      p.position.y += p.userData.vy;
      p.rotation.z += p.userData.vr;
      if (p.position.y > 25) p.position.y = -25;
    });
    renderer.render(scene, camera);
  }
  animateLoader();

  // GSAP loader animations
  const tl = gsap.timeline();
  tl.to('#load-initials',  { opacity: 1, y: 0, duration: 1, ease: 'power2.out', delay: 0.3 }, 0)
    .to('#load-subtitle',  { opacity: 1, duration: 0.8, ease: 'power2.out' }, 0.8)
    .to('#load-date',      { opacity: 1, duration: 0.8, ease: 'power2.out' }, 1.1)
    .to('#load-progress',  { opacity: 1, duration: 0.6, ease: 'power2.out' }, 1.4);

  // Progress bar
  let progress = 0;
  const fill = document.getElementById('progress-fill');
  const progressInt = setInterval(() => {
    progress += Math.random() * 4 + 1;
    if (progress >= 100) { progress = 100; clearInterval(progressInt); }
    fill.style.width = progress + '%';
  }, 60);

  // Floating hearts on loader
  const hContainer = document.getElementById('loader-hearts');
  const heartEmojis = ['‚ô•','üíï','üíñ','üíó','üåπ','‚ú®'];
  for (let i = 0; i < 18; i++) {
    const h = document.createElement('span');
    h.className = 'loader-heart';
    h.textContent = heartEmojis[Math.floor(Math.random() * heartEmojis.length)];
    h.style.setProperty('--x', Math.random() * 100 + '%');
    h.style.setProperty('--dur', (Math.random() * 4 + 3) + 's');
    h.style.setProperty('--delay', (Math.random() * 4) + 's');
    h.style.setProperty('--size', (Math.random() * 1.5 + 0.8) + 'rem');
    hContainer.appendChild(h);
  }

  // Initials from config
  document.getElementById('load-initials').textContent = CONFIG.initials;

  // Transition out after ~4s
  setTimeout(() => {
    animRunning = false;
    gsap.to('#loading-screen', {
      opacity: 0, duration: 1, ease: 'power2.inOut',
      onComplete: () => {
        document.getElementById('loading-screen').style.display = 'none';
        renderer.dispose();
        initMainSite();
      }
    });
  }, 4200);

  window.addEventListener('resize', () => {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  });
})();

/* ============================================================
   MAIN SITE INIT
   ============================================================ */
function initMainSite() {
  gsap.to('#main-site', { opacity: 1, duration: 1, ease: 'power2.out' });

  // Register GSAP plugins
  gsap.registerPlugin(ScrollTrigger, TextPlugin, MotionPathPlugin);

  initNav();
  initHeroCanvas();
  initHero();
  initEnvelope();
  initGallery();
  initCalculator();
  initLoveList();
  initUnlockSection();
  initFooter();
  initScrollAnimations();
  updateCountdowns();
  setInterval(updateCountdowns, 1000);
}

/* ============================================================
   NAV
   ============================================================ */
function initNav() {
  const nav = document.getElementById('site-nav');
  window.addEventListener('scroll', () => {
    nav.classList.toggle('visible', window.scrollY > 200);
  });
}

/* ============================================================
   HERO THREE.JS CANVAS
   ============================================================ */
function initHeroCanvas() {
  const canvas   = document.getElementById('hero-canvas');
  const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
  renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5));
  renderer.setSize(canvas.offsetWidth, canvas.offsetHeight);

  const scene  = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(60, canvas.offsetWidth / canvas.offsetHeight, 0.1, 200);
  camera.position.z = 40;

  // Falling hearts
  const heartShape = new THREE.Shape();
  heartShape.moveTo(0, 0);
  heartShape.bezierCurveTo(0, -2, -3, -2, -3, 0);
  heartShape.bezierCurveTo(-3, 2, 0, 4, 0, 5);
  heartShape.bezierCurveTo(0, 4, 3, 2, 3, 0);
  heartShape.bezierCurveTo(3, -2, 0, -2, 0, 0);

  const geo = new THREE.ShapeGeometry(heartShape);
  const heroParticles = [];

  function makeHeroHeart() {
    const m = new THREE.MeshBasicMaterial({
      color: new THREE.Color().setHSL(Math.random() < 0.5 ? 0.97 : 0.08, 0.7, 0.6 + Math.random() * 0.3),
      transparent: true,
      opacity: Math.random() * 0.4 + 0.1,
    });
    const mesh = new THREE.Mesh(geo, m);
    const s = Math.random() * 1.2 + 0.3;
    mesh.scale.set(s, s, s);
    mesh.position.set((Math.random() - 0.5) * 80, 30 + Math.random() * 20, (Math.random() - 0.5) * 20);
    mesh.rotation.z = Math.PI + (Math.random() - 0.5) * 0.5;
    mesh.userData = { vy: -(Math.random() * 0.08 + 0.03), vr: (Math.random() - 0.5) * 0.005 };
    scene.add(mesh);
    heroParticles.push(mesh);
  }

  for (let i = 0; i < 40; i++) makeHeroHeart();

  function animateHero() {
    requestAnimationFrame(animateHero);
    heroParticles.forEach(p => {
      p.position.y += p.userData.vy;
      p.rotation.z += p.userData.vr;
      if (p.position.y < -30) {
        p.position.y = 30 + Math.random() * 20;
        p.position.x = (Math.random() - 0.5) * 80;
      }
    });
    renderer.render(scene, camera);
  }
  animateHero();

  window.addEventListener('resize', () => {
    renderer.setSize(canvas.offsetWidth, canvas.offsetHeight);
    camera.aspect = canvas.offsetWidth / canvas.offsetHeight;
    camera.updateProjectionMatrix();
  });
}

/* ============================================================
   HERO ANIMATIONS
   ============================================================ */
function initHero() {
  // Update from config
  document.getElementById('hero-subtitle-name').textContent = CONFIG.partnerName + "'s";
  document.getElementById('hero-byline').textContent =
    "A story of pursuit, confession & our mutual love";

  gsap.from('.cover-frame', { scale: 0.85, opacity: 0, duration: 1.2, ease: 'elastic.out(1,0.7)', delay: 0.2 });
  gsap.from('.hero-title',  { y: 20, opacity: 0, duration: 0.8, delay: 0.6 });
  gsap.from('.hero-byline', { y: 15, opacity: 0, duration: 0.7, delay: 0.9 });
  gsap.from('.hero-date-stamp', { scale: 0.7, opacity: 0, duration: 0.6, delay: 1.1 });
  gsap.from('.cover-tape',  { scaleX: 0, duration: 0.5, stagger: 0.15, delay: 1.4 });

  // Sticker sparkle on hover over hero
  document.querySelector('.cover-frame').addEventListener('mousemove', e => {
    if (Math.random() > 0.85) spawnHeart(e.clientX, e.clientY, 1);
  });
}

/* ============================================================
   ENVELOPE / LETTER
   ============================================================ */
function initEnvelope() {
  const btn    = document.getElementById('envelope-container');
  const flap   = document.getElementById('env-flap');
  const modal  = document.getElementById('letter-modal');
  const close  = document.getElementById('letter-close');
  const back   = document.getElementById('letter-backdrop');
  const target = document.getElementById('letter-text-typed');

  let opened = false;

  function openLetter() {
    if (opened) return;
    opened = true;

    // Flap opens
    gsap.to(flap, {
      rotateX: -180,
      duration: 0.7,
      ease: 'power2.inOut',
      transformOrigin: 'top center',
      onComplete: () => {
        // Show modal
        modal.style.display = 'flex';
        gsap.from('#letter-paper-full', { y: 60, opacity: 0, scale: 0.9, duration: 0.7, ease: 'back.out(1.5)' });

        // Spawn rose petals
        for (let i = 0; i < 12; i++) {
          setTimeout(() => spawnPetal(), i * 200);
        }

        // Type letter
        target.innerHTML = '';
        typeLetterContent(target, CONFIG.letterText, CONFIG.partnerName, CONFIG.myName);
      }
    });
  }

  btn.addEventListener('click', openLetter);
  btn.addEventListener('keydown', e => { if (e.key === 'Enter' || e.key === ' ') openLetter(); });

  close.addEventListener('click', () => {
    gsap.to('#letter-paper-full', { y: -40, opacity: 0, duration: 0.4, onComplete: () => {
      modal.style.display = 'none';
      opened = false;
      gsap.to(flap, { rotateX: 0, duration: 0.4 });
    }});
  });
  back.addEventListener('click', () => close.click());
}

function typeLetterContent(container, text, partnerName, myName) {
  const salutation = document.createElement('span');
  salutation.className = 'lf-salutation';
  salutation.textContent = `My dearest ${partnerName},`;
  container.appendChild(salutation);

  const bodyEl = document.createElement('span');
  container.appendChild(bodyEl);

  const sig = document.createElement('span');
  sig.className = 'lf-signature';
  sig.style.opacity = '0';
  sig.textContent = `Forever yours,\n${myName} ‚ô•`;
  container.appendChild(sig);

  const lines = text.split('\n').filter(l => l.trim());
  // Skip first line (salutation handled above)
  const bodyLines = lines.slice(1);

  let charIdx = 0;
  const fullText = bodyLines.join('\n\n');
  const typeInterval = setInterval(() => {
    if (charIdx < fullText.length) {
      bodyEl.textContent += fullText[charIdx];
      charIdx++;
      container.parentElement.scrollTop = container.parentElement.scrollHeight;
    } else {
      clearInterval(typeInterval);
      gsap.to(sig, { opacity: 1, duration: 0.8, delay: 0.3 });
    }
  }, 22);
}

function spawnPetal() {
  const petal = document.createElement('div');
  petal.className = 'rose-petal';
  petal.textContent = ['üå∏','üåπ','üå∑','‚úø','‚ùÄ'][Math.floor(Math.random() * 5)];
  petal.style.left = Math.random() * 100 + 'vw';
  petal.style.top  = '0';
  petal.style.fontSize = (Math.random() * 0.8 + 0.7) + 'rem';
  document.body.appendChild(petal);
  setTimeout(() => petal.remove(), 4500);
}

/* ============================================================
   GALLERY
   ============================================================ */
function initGallery() {
  const grid = document.getElementById('polaroid-grid');
  const stickers = ['‚≠ê','üéÄ','üíï','üåü','‚ú®','üå∏'];

  CONFIG.galleryPhotos.forEach((photo, i) => {
    const div = document.createElement('div');
    div.className = 'polaroid';
    div.setAttribute('role', 'listitem');
    div.setAttribute('tabindex', '0');
    div.setAttribute('aria-label', `Photo: ${photo.label}`);
    div.style.setProperty('--rot', ((i % 2 === 0 ? -1 : 1) * (Math.random() * 3 + 1)) + 'deg');

    const placeholder = document.createElement('div');
    placeholder.className = 'photo-placeholder';
    placeholder.innerHTML = `<span style="font-size:2.5rem">${photo.emoji}</span><span>Add Photo Here\n${photo.label}</span>`;
    placeholder.setAttribute('aria-hidden', 'true');

    const caption = document.createElement('div');
    caption.className = 'polaroid-caption';
    caption.textContent = photo.label;

    const sticker = document.createElement('div');
    sticker.className = 'polaroid-sticker';
    sticker.textContent = stickers[i % stickers.length];
    sticker.setAttribute('aria-hidden', 'true');

    ['tl','tr','bl','br'].forEach(c => {
      const corner = document.createElement('div');
      corner.className = `polaroid-corner pc-${c}`;
      corner.setAttribute('aria-hidden', 'true');
      div.appendChild(corner);
    });

    div.appendChild(placeholder);
    div.appendChild(caption);
    div.appendChild(sticker);
    grid.appendChild(div);

    // Click to enlarge
    div.addEventListener('click', () => openLightbox(photo, i));
    div.addEventListener('keydown', e => { if (e.key === 'Enter') openLightbox(photo, i); });

    // Sticker peel on hover
    sticker.addEventListener('mouseenter', () => {
      gsap.to(sticker, { scale: 1.4, rotate: 20, duration: 0.2 });
    });
    sticker.addEventListener('mouseleave', () => {
      gsap.to(sticker, { scale: 1, rotate: 15, duration: 0.3 });
    });

    // Entrance animation via ScrollTrigger
    gsap.from(div, {
      scrollTrigger: { trigger: div, start: 'top 90%' },
      scale: 0.6,
      opacity: 0,
      rotation: (Math.random() - 0.5) * 30,
      duration: 0.7,
      delay: i * 0.1,
      ease: 'back.out(1.6)',
    });
  });
}

function openLightbox(photo, idx) {
  const lb    = document.getElementById('lightbox');
  const wrap  = document.getElementById('lightbox-img-wrap');
  lb.style.display = 'flex';

  wrap.innerHTML = `
    <div class="lightbox-img" style="
      width:min(320px,85vw);
      aspect-ratio:1;
      background:linear-gradient(135deg,#f9a8b8,#e8254a);
      display:flex;
      align-items:center;
      justify-content:center;
      flex-direction:column;
      gap:1rem;
      color:white;
      font-family:'Dancing Script',cursive;
    " aria-label="${photo.label}">
      <span style="font-size:4rem">${photo.emoji}</span>
      <span style="font-size:1.4rem">${photo.label}</span>
      <span style="font-size:0.9rem;opacity:0.7;">Replace with personal photo</span>
    </div>`;

  gsap.from(wrap, { scale: 0.7, opacity: 0, duration: 0.4, ease: 'back.out(1.5)' });

  // Heart burst
  for (let i = 0; i < 8; i++) {
    const rect = wrap.getBoundingClientRect();
    setTimeout(() => spawnHeart(rect.left + rect.width / 2, rect.top + rect.height / 2, 2), i * 100);
  }
}

document.getElementById('lightbox-close').addEventListener('click', () => {
  const lb = document.getElementById('lightbox');
  gsap.to(lb, { opacity: 0, duration: 0.3, onComplete: () => {
    lb.style.display = 'none';
    lb.style.opacity = '';
  }});
});

document.getElementById('lightbox').addEventListener('click', e => {
  if (e.target === document.getElementById('lightbox')) {
    document.getElementById('lightbox-close').click();
  }
});

/* ============================================================
   CALCULATOR
   ============================================================ */
function initCalculator() {
  const btn = document.getElementById('calc-btn');
  btn.addEventListener('click', () => {
    const n1 = document.getElementById('name1').value.trim();
    const n2 = document.getElementById('name2').value.trim();
    if (!n1 || !n2) return;

    // Playful hash
    const combined = (n1 + n2).toLowerCase().replace(/\s/g,'');
    let hash = 0;
    for (let c of combined) hash = (hash * 31 + c.charCodeAt(0)) % 100;
    const pct = Math.max(75, hash); // always high for romance!

    const meter    = document.getElementById('love-meter');
    const fill     = document.getElementById('meter-fill');
    const pctEl    = document.getElementById('compat-pct');
    const result   = document.getElementById('meter-result');
    const bar      = document.querySelector('.meter-bar-outer');

    meter.style.display = 'block';
    result.style.display = 'none';
    fill.style.width = '0%';
    pctEl.textContent = '0';

    gsap.to({ val: 0 }, {
      val: pct,
      duration: 2,
      ease: 'power2.out',
      onUpdate: function() {
        const v = Math.round(this.targets()[0].val);
        pctEl.textContent = v;
        fill.style.width  = v + '%';
        bar.setAttribute('aria-valuenow', v);
        fill.innerHTML = Array(Math.floor(v/14)).fill('‚ù§').join('');
      },
      onComplete: () => {
        result.style.display = 'block';
        const msgs = [
          `${n1} + ${n2} = a love story written in the stars! üí´`,
          `The universe knows you two belong together! üåπ`,
          `Soul mates ‚Äî no calculation needed! üíñ`,
        ];
        result.textContent = msgs[Math.floor(Math.random() * msgs.length)];
        gsap.from(result, { y: 10, opacity: 0, duration: 0.5 });

        // Burst hearts
        const r = btn.getBoundingClientRect();
        for (let i = 0; i < 12; i++) setTimeout(() => spawnHeart(r.left + r.width/2, r.top, 1.5), i * 80);
      }
    });
  });
}

/* ============================================================
   COUNTDOWN
   ============================================================ */
function updateCountdowns() {
  const now = new Date();

  // Valentine's Day countdown
  const vDiff = CONFIG.valentinesDay - now;
  if (vDiff > 0) {
    const days  = Math.floor(vDiff / 864e5);
    const hours = Math.floor((vDiff % 864e5) / 36e5);
    const mins  = Math.floor((vDiff % 36e5) / 6e4);
    const secs  = Math.floor((vDiff % 6e4) / 1e3);
    document.getElementById('cd-days').textContent  = String(days).padStart(2,'0');
    document.getElementById('cd-hours').textContent = String(hours).padStart(2,'0');
    document.getElementById('cd-mins').textContent  = String(mins).padStart(2,'0');
    document.getElementById('cd-secs').textContent  = String(secs).padStart(2,'0');
  } else {
    document.getElementById('cd-days').textContent  = '00';
    document.getElementById('cd-hours').textContent = '00';
    document.getElementById('cd-mins').textContent  = '00';
    document.getElementById('cd-secs').textContent  = '00';
  }

  // Courting days
  const cDiff = now - CONFIG.courtshipStart;
  document.getElementById('courting-days').textContent = Math.floor(cDiff / 864e5);
}

/* ============================================================
   LOVE LIST
   ============================================================ */
function initLoveList() {
  const container = document.getElementById('love-list');

  CONFIG.loveList.forEach((item, i) => {
    const div = document.createElement('div');
    div.className = 'love-item';
    div.setAttribute('role', 'listitem');
    div.innerHTML = `
      <div class="love-number" aria-hidden="true">${String(i + 1).padStart(2,'0')}</div>
      <div class="love-text-wrap">
        <div class="love-heading">${item.heading}</div>
        <div class="love-body">${item.body}</div>
      </div>
      <div class="love-emoji" aria-hidden="true">${item.emoji}</div>
    `;
    container.appendChild(div);

    // Scroll reveal
    const obs = new IntersectionObserver((entries) => {
      entries.forEach(e => {
        if (e.isIntersecting) {
          setTimeout(() => e.target.classList.add('visible'), i * 120);
          obs.unobserve(e.target);
        }
      });
    }, { threshold: 0.2 });
    obs.observe(div);
  });
}

/* ============================================================
   UNLOCK / STARS / SPICY GALLERY
   ============================================================ */
function initUnlockSection() {
  // Stars
  const starsContainer = document.getElementById('unlock-stars');
  for (let i = 0; i < 80; i++) {
    const star = document.createElement('div');
    star.className = 'star-dot';
    star.style.left = Math.random() * 100 + '%';
    star.style.top  = Math.random() * 100 + '%';
    star.style.setProperty('--dur',  (Math.random() * 3 + 2) + 's');
    star.style.setProperty('--del',  (Math.random() * 3) + 's');
    starsContainer.appendChild(star);
  }

  // Open password modal
  const heartBtn = document.getElementById('heart-lock-btn');
  const pwModal  = document.getElementById('pw-modal');
  const pwClose  = document.getElementById('pw-close');
  const pwBack   = document.getElementById('pw-backdrop');
  const pwInput  = document.getElementById('pw-input');
  const pwSubmit = document.getElementById('pw-submit');
  const pwError  = document.getElementById('pw-error');

  function openPW() {
    pwModal.style.display = 'flex';
    pwInput.value = '';
    pwError.style.display = 'none';
    gsap.from('.pw-box', { scale: 0.8, opacity: 0, duration: 0.4, ease: 'back.out(1.5)' });
    setTimeout(() => pwInput.focus(), 100);
  }

  heartBtn.addEventListener('click', openPW);
  heartBtn.addEventListener('keydown', e => { if (e.key === 'Enter' || e.key === ' ') openPW(); });

  pwClose.addEventListener('click', () => { pwModal.style.display = 'none'; });
  pwBack.addEventListener('click',  () => { pwModal.style.display = 'none'; });

  pwInput.addEventListener('keydown', e => { if (e.key === 'Enter') pwSubmit.click(); });

  pwSubmit.addEventListener('click', () => {
    if (pwInput.value.toLowerCase().trim() === CONFIG.spicyPassword) {
      pwModal.style.display = 'none';
      unlockSpicy();
    } else {
      pwError.style.display = 'block';
      pwError.style.animation = 'none';
      setTimeout(() => pwError.style.animation = 'shake 0.4s ease', 10);
      gsap.from(pwInput, { x: -8, duration: 0.4, ease: 'elastic.out(1, 0.3)' });
    }
  });

  // Build spicy gallery (hidden)
  buildSpicyGallery();
}

function unlockSpicy() {
  // Animate lock breaking
  const lockIcon = document.querySelector('.lock-icon');
  const heartSvg = document.querySelector('.heart-main-svg');
  const chainSvg = document.querySelector('.chain-svg');

  gsap.timeline()
    .to(lockIcon, { scale: 1.5, duration: 0.2 })
    .to(lockIcon, { scale: 0, opacity: 0, duration: 0.3, ease: 'back.in(2)' })
    .to(chainSvg, { opacity: 0, duration: 0.5 }, '-=0.2')
    .to(heartSvg, {
      filter: 'drop-shadow(0 0 60px rgba(232,37,74,1)) drop-shadow(0 0 30px rgba(255,200,100,0.8))',
      duration: 0.8, ease: 'power2.inOut'
    }, '-=0.3')
    .call(() => {
      launchConfetti(200);
      setTimeout(showCurtains, 500);
    });
}

function showCurtains() {
  const cL = document.getElementById('curtain-left');
  const cR = document.getElementById('curtain-right');
  cL.style.display = 'block';
  cR.style.display = 'block';

  // Show curtains then open them
  gsap.timeline()
    .from([cL, cR], { scaleX: 0, duration: 0.3 })
    .to([cL, cR], {
      delay: 0.5,
      onStart: () => {
        document.getElementById('spicy-section').style.display = 'block';
        initSpicyCanvas();
        animateSpicyGallery();
        document.getElementById('spicy-section').scrollIntoView({ behavior: 'smooth' });
      },
    })
    .call(() => {
      cL.classList.add('open');
      cR.classList.add('open');
      setTimeout(() => {
        cL.style.display = 'none';
        cR.style.display = 'none';
        cL.classList.remove('open');
        cR.classList.remove('open');
      }, 1600);
    });
}

function buildSpicyGallery() {
  const grid = document.getElementById('spicy-grid');
  const rotations = [-3, 2, -1.5, 3.5, -2, 1];

  CONFIG.spicyPhotos.forEach((photo, i) => {
    const item = document.createElement('div');
    item.className = 'spicy-item';
    item.style.setProperty('--sr', rotations[i % rotations.length] + 'deg');
    item.setAttribute('aria-label', photo.label);

    const placeholder = document.createElement('div');
    placeholder.className = 'spicy-photo-placeholder';
    placeholder.innerHTML = `<span style="font-size:3rem">${photo.emoji}</span><span>Add Your Photo\n${photo.label}</span>`;
    placeholder.setAttribute('aria-hidden', 'true');

    const caption = document.createElement('div');
    caption.className = 'spicy-caption';
    caption.textContent = photo.label;

    item.appendChild(placeholder);
    item.appendChild(caption);
    grid.appendChild(item);
  });
}

function animateSpicyGallery() {
  const items = document.querySelectorAll('.spicy-item');
  items.forEach((item, i) => {
    gsap.to(item, {
      scale: 1,
      opacity: 1,
      rotation: parseFloat(item.style.getPropertyValue('--sr') || '0'),
      duration: 0.8,
      delay: 0.5 + i * 0.15,
      ease: 'back.out(1.4)',
    });
  });
}

function initSpicyCanvas() {
  const canvas = document.getElementById('spicy-canvas');
  const renderer = new THREE.WebGLRenderer({ canvas, alpha: true, antialias: true });
  renderer.setPixelRatio(Math.min(window.devicePixelRatio, 1.5));
  renderer.setSize(canvas.offsetWidth, canvas.offsetHeight);

  const scene  = new THREE.Scene();
  const camera = new THREE.PerspectiveCamera(60, canvas.offsetWidth / canvas.offsetHeight, 0.1, 200);
  camera.position.z = 40;

  const heartShape = new THREE.Shape();
  heartShape.moveTo(0, 0);
  heartShape.bezierCurveTo(0, -2, -3, -2, -3, 0);
  heartShape.bezierCurveTo(-3, 2, 0, 4, 0, 5);
  heartShape.bezierCurveTo(0, 4, 3, 2, 3, 0);
  heartShape.bezierCurveTo(3, -2, 0, -2, 0, 0);

  const geo = new THREE.ShapeGeometry(heartShape);
  const goldParticles = [];

  for (let i = 0; i < 30; i++) {
    const m = new THREE.MeshBasicMaterial({
      color: new THREE.Color().setHSL(0.1 + Math.random() * 0.05, 0.8, 0.6 + Math.random() * 0.2),
      transparent: true,
      opacity: Math.random() * 0.5 + 0.2,
    });
    const mesh = new THREE.Mesh(geo, m);
    const s = Math.random() * 1.5 + 0.3;
    mesh.scale.set(s, s, s);
    mesh.position.set((Math.random() - 0.5) * 80, (Math.random() - 0.5) * 60, (Math.random() - 0.5) * 20);
    mesh.rotation.z = Math.PI + (Math.random() - 0.5);
    mesh.userData = { vy: (Math.random() - 0.5) * 0.05, vr: (Math.random() - 0.5) * 0.008 };
    scene.add(mesh);
    goldParticles.push(mesh);
  }

  function anim() {
    requestAnimationFrame(anim);
    goldParticles.forEach(p => {
      p.position.y += p.userData.vy;
      p.rotation.z  += p.userData.vr;
      if (Math.abs(p.position.y) > 35) p.userData.vy *= -1;
    });
    renderer.render(scene, camera);
  }
  anim();
}

/* ============================================================
   SCROLL ANIMATIONS
   ============================================================ */
function initScrollAnimations() {
  // Section titles
  gsap.utils.toArray('.section-title').forEach(el => {
    gsap.from(el, {
      scrollTrigger: { trigger: el, start: 'top 85%' },
      y: 25, opacity: 0, duration: 0.7, ease: 'power2.out'
    });
  });

  // Countdown card
  gsap.from('.countdown-card', {
    scrollTrigger: { trigger: '.countdown-card', start: 'top 85%' },
    y: 30, opacity: 0, duration: 0.7, delay: 0.2, ease: 'power2.out'
  });

  // Calc card
  gsap.from('.calc-card', {
    scrollTrigger: { trigger: '.calc-card', start: 'top 85%' },
    y: 30, opacity: 0, rotation: -1, duration: 0.7, ease: 'power2.out'
  });

  // Unlock section
  gsap.from('.chained-heart-wrap', {
    scrollTrigger: { trigger: '#unlock-section', start: 'top 70%' },
    scale: 0.5, opacity: 0, duration: 1, ease: 'elastic.out(1, 0.6)'
  });
}

/* ============================================================
   FOOTER / SURPRISE
   ============================================================ */
function initFooter() {
  const btn = document.getElementById('surprise-btn');
  const msg = document.getElementById('surprise-message');

  btn.addEventListener('click', () => {
    const chosen = CONFIG.surpriseMessages[Math.floor(Math.random() * CONFIG.surpriseMessages.length)];
    msg.textContent = chosen;
    msg.style.display = 'block';
    gsap.from(msg, { y: 20, opacity: 0, duration: 0.6, ease: 'back.out(1.5)' });
    launchConfetti(80);
    btn.textContent = 'üíï Another Surprise üíï';
  });
}

/* ============================================================
   CONFETTI
   ============================================================ */
function launchConfetti(count = 60) {
  const colors = ['#e8254a','#f9a8b8','#c9993b','#f0d080','#b06080','#ffffff'];
  for (let i = 0; i < count; i++) {
    const conf = document.createElement('div');
    conf.className = 'confetti-piece';
    conf.style.setProperty('--dur', (Math.random() * 2 + 2) + 's');
    conf.style.setProperty('--del', (Math.random() * 0.5) + 's');
    conf.style.setProperty('--dx',  ((Math.random() - 0.5) * 200) + 'px');
    conf.style.background = colors[Math.floor(Math.random() * colors.length)];
    conf.style.left = Math.random() * 100 + 'vw';
    conf.style.top  = '0';
    conf.style.width  = (Math.random() * 8 + 4) + 'px';
    conf.style.height = (Math.random() * 8 + 4) + 'px';
    conf.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
    document.body.appendChild(conf);
    setTimeout(() => conf.remove(), 5000);
  }
}

/* ============================================================
   SPAWN HEARTS (cursor trail & hover effects)
   ============================================================ */
function spawnHeart(x, y, size = 1) {
  const h = document.createElement('div');
  h.style.cssText = `
    position:fixed;
    left:${x}px; top:${y}px;
    font-size:${size}rem;
    pointer-events:none;
    z-index:9998;
    animation: floatHeartUp 1.5s ease-out forwards;
    transform: translate(-50%,-50%);
  `;
  h.textContent = ['‚ô•','üíï','‚ù§Ô∏è','üíñ'][Math.floor(Math.random() * 4)];

  if (!document.getElementById('heart-style')) {
    const s = document.createElement('style');
    s.id = 'heart-style';
    s.textContent = `@keyframes floatHeartUp {
      0%   { transform: translate(-50%,-50%) scale(1); opacity: 1; }
      100% { transform: translate(calc(-50% + ${(Math.random()-0.5)*60}px), calc(-50% - 80px)) scale(0.3); opacity: 0; }
    }`;
    document.head.appendChild(s);
  }

  document.body.appendChild(h);
  setTimeout(() => h.remove(), 1600);
}

// Spawn hearts on mousemove occasionally
let heartTimer = 0;
document.addEventListener('mousemove', e => {
  const now = Date.now();
  if (now - heartTimer > 300 && Math.random() > 0.7 && document.getElementById('main-site').style.opacity !== '0') {
    heartTimer = now;
    spawnHeart(e.clientX, e.clientY, 0.7);
  }
});

</script>
</body>
</html>
